import { Meta, Canvas, Story, ArgsTable } from '@storybook/blocks';

import { Information, TokensTable } from '../../../../../../docs-components';

import { LegacySelect } from './';

<Meta
  title='Avviklet/LegacySelect/Flervalgsmeny'
  component={LegacySelect}
  argTypes={{
    multiple: {
      description:
        'Må være satt for å gi brukeren mulighet til å velge flere alternativer.',
    },
    label: {
      description: 'Tekst som vises over feltet.',
      control: {
        type: 'text',
      },
    },
    disabled: {
      description: 'Settes for å deaktivere feltet.',
      control: {
        type: 'boolean',
      },
    },
    error: {
      description: 'Settes for å indikere at det er en feil tilknyttet feltet.',
      control: {
        type: 'boolean',
      },
    },
    options: {
      description:
        'Liste med alternativer som skal vises i nedtrekkslisten. ' +
        'Alternativene er av typen `MultiSelectOption` og har følgende egenskaper:\n' +
        '- `value` er verdien som brukes av `onChange`-funksjonen.\n' +
        '- `label` er teksten som vises i listen.\n' +
        '- `deleteButtonLabel` er alternativ tekst til sletteknappen som vises i feltet når alternativet er valgt. Denne brukes bl.a. av skjermlesere.\n' +
        '- `formattedLabel` vises i listen i stedet for `label` hvis den er satt. Dette gir mulighet til å formatere teksten. `label` vil fortsatt være det som vises for de valgte alternativene når boksen er lukket.\n' +
        '- `keywords` er en valgfri liste med nøkkelord som brukes som oppslag når brukeren skriver i søkefeltet. Dette er nyttig hvis brukeren skal kunne søke etter andre ting enn det som står i `label`, f.eks. tekst som brukes i `formattedLabel`.',
      control: {
        type: 'object',
      },
    },
    onChange: {
      description:
        'Funksjon som kalles når brukeren velger et alternativ. De valgte alternativenes `value` sendes som parameter til funksjonen i form av en liste.',
      control: {
        type: 'function',
      },
    },
    value: {
      description: 'Kan brukes til å overstyre hvilke verdier som er valgt.',
      control: {
        type: 'text',
      },
    },
    deleteButtonLabel: {
      description:
        'Alternativ tekst til knappen som fjerner alle de valgte alternativene fra listen over valgte alternativer. Denne brukes bl.a. av skjermlesere.',
      control: {
        type: 'text',
      },
    },
    hideLabel: {
      description:
        'Skjuler teksten over feltet, men gjør den likevel tilgjengelig for verktøy som skjermlesere.',
      control: {
        type: 'boolean',
      },
    },
    inputId: {
      description:
        'Gir input-feltet en ID. Dersom denne ikke satt, genereres en unik ID automatisk.',
      control: {
        type: 'text',
      },
    },
    portal: {
      description:
        'Når denne er true blir listeelemenetene rendret i en portal',
      control: {
        type: 'boolean',
      },
      defaultValue: 'true',
    },
  }}
/>

export const defaultArgs = {
  deleteButtonLabel: 'Fjern alle',
  label: 'Velg ett eller flere fylker',
  multiple: true,
  options: [
    {
      label: 'Agder',
      value: 'Agd',
      keywords: ['agder', 'aust-agder', 'vest-agder'],
    },
    {
      label: 'Innlandet',
      value: 'Inn',
      keywords: ['innlandet', 'hedmark', 'oppland'],
    },
    {
      label: 'Møre og Romsdal',
      value: 'MoR',
      keywords: ['møre og romsdal', 'møre', 'romsdal'],
    },
    { label: 'Nordland', value: 'Nor', keywords: ['nordland'] },
    { label: 'Oslo', value: 'Osl', keywords: ['oslo'] },
    { label: 'Rogaland', value: 'Rog', keywords: ['rogaland'] },
    {
      label: 'Vestfold og Telemark',
      value: 'VoT',
      keywords: ['vestfold og telemark', 'vestfold', 'telemark'],
    },
    {
      label: 'Troms og Finnmark',
      value: 'ToF',
      keywords: ['troms og finnmark', 'troms', 'finnmark'],
    },
    {
      label: 'Trøndelag',
      value: 'Trø',
      keywords: ['trøndelag', 'nord-trøndelag', 'sør-trøndelag'],
    },
    {
      label: 'Vestland',
      value: 'Ves',
      keywords: ['vestland', 'hordaland', 'sogn og fjordane'],
    },
    {
      label: 'Viken',
      value: 'Vik',
      keywords: ['viken', 'østfold', 'akershus', 'buskerud'],
    },
  ].map((option) => ({
    ...option,
    deleteButtonLabel: 'Slett ' + option.label,
  })),
};
export const Template = (args = {}) => (
  <div style={{ width: '440px' }}>
    <LegacySelect {...{ ...defaultArgs, ...args }} />
  </div>
);

# LegacySelect (flervalg)

<Information
  text='deprecated'
  description='**Denne komponenten er erstattet av [Combobox](/?path=/docs/komponenter-combobox--docs) komponent.**'
/>

Når `multiple`-egenskapen er satt på, `LegacySelect` får brukeren mulighet til å velge flere enn ett alternativ.
Verdien i feltet behandles da som en liste med tekststrenger.

## Eksempler

### Normal visning

<Canvas>
  <Story
    name='Normal'
    args={{}}
  >
    {Template.bind({})}
  </Story>
</Canvas>

### Deaktivert

<Canvas>
  <Story
    name='Deaktivert'
    args={{ disabled: true }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

### Med feil

<Canvas>
  <Story
    name='Med feil'
    args={{ error: true }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

### Med formaterte alternativer

<Canvas>
  <Story
    name='Formaterte alternativer'
    args={{
      options: [
        {
          label: 'Agder',
          value: 'Agd',
          keywords: ['agder'],
          formattedLabel: (
            <span style={{ display: 'flex', flexDirection: 'column' }}>
              <strong>Agder</strong>
              <span>
                Arendal, Farsund, Flekkefjord, Grimstad, Kristiansand,
                Lillesand, Lyngdal, Mandal, Risør, Tvedestrand
              </span>
            </span>
          ),
          deleteButtonLabel: 'Fjern Agder',
        },
        {
          label: 'Innlandet',
          value: 'Inn',
          keywords: ['innlandet'],
          formattedLabel: (
            <span style={{ display: 'flex', flexDirection: 'column' }}>
              <strong>Innlandet</strong>
              <span>
                Brumunddal, Elverum, Fagernes, Gjøvik, Hamar, Kongsvinger,
                Lillehammer, Moelv, Otta, Raufoss, Vinstra
              </span>
            </span>
          ),
          deleteButtonLabel: 'Fjern Innlandet',
        },
        {
          label: 'Møre og Romsdal',
          value: 'MoR',
          keywords: ['møre og romsdal', 'møre', 'romsdal'],
          formattedLabel: (
            <span style={{ display: 'flex', flexDirection: 'column' }}>
              <strong>Møre og Romsdal</strong>
              <span>
                Fosnavåg, Kristiansund, Molde, Ulsteinvik, Ålesund, Åndalsnes
              </span>
            </span>
          ),
          deleteButtonLabel: 'Fjern Møre og Romsdal',
        },
        {
          label: 'Nordland',
          value: 'Nor',
          keywords: ['nordland'],
          formattedLabel: (
            <span style={{ display: 'flex', flexDirection: 'column' }}>
              <strong>Nordland</strong>
              <span>
                Bodø, Brønnøysund, Fauske, Leknes, Mo i Rana, Mosjøen, Narvik,
                Sandnessjøen, Sortland, Stokmarknes, Svolvær
              </span>
            </span>
          ),
          deleteButtonLabel: 'Fjern Nordland',
        },
        {
          label: 'Oslo',
          value: 'Osl',
          keywords: ['oslo'],
          formattedLabel: (
            <span style={{ display: 'flex', flexDirection: 'column' }}>
              <strong>Oslo</strong>
              <span>Oslo</span>
            </span>
          ),
          deleteButtonLabel: 'Fjern Oslo',
        },
        {
          label: 'Rogaland',
          value: 'Rog',
          keywords: ['rogaland'],
          formattedLabel: (
            <span style={{ display: 'flex', flexDirection: 'column' }}>
              <strong>Rogaland</strong>
              <span>
                Bryne, Egersund, Haugesund, Jørpeland, Kopervik, Sandnes, Sauda,
                Skudeneshavn, Stavanger, Åkrehamn
              </span>
            </span>
          ),
          deleteButtonLabel: 'Fjern Rogaland',
        },
        {
          label: 'Troms og Finnmark',
          value: 'ToF',
          keywords: ['troms og finnmark', 'troms', 'finnmark'],
          formattedLabel: (
            <span style={{ display: 'flex', flexDirection: 'column' }}>
              <strong>Troms og Finnmark</strong>
              <span>
                Alta, Bardufoss, Finnsnes, Hammerfest, Harstad, Honningsvåg,
                Kirkenes, Tromsø, Vadsø, Vardø
              </span>
            </span>
          ),
          deleteButtonLabel: 'Fjern Troms og Finnmark',
        },
        {
          label: 'Trøndelag',
          value: 'Trø',
          keywords: ['trøndelag', 'nord-trøndelag', 'sør-trøndelag'],
          formattedLabel: (
            <span style={{ display: 'flex', flexDirection: 'column' }}>
              <strong>Trøndelag</strong>
              <span>
                Brekstad, Kolvereid, Levanger, Namsos, Orkanger, Røros, Rørvik,
                Steinkjer, Stjørdalshalsen, Trondheim, Verdalsøra
              </span>
            </span>
          ),
          deleteButtonLabel: 'Fjern Trøndelag',
        },
        {
          label: 'Vestfold og Telemark',
          value: 'VoT',
          keywords: ['vestfold og telemark', 'vestfold', 'telemark'],
          formattedLabel: (
            <span style={{ display: 'flex', flexDirection: 'column' }}>
              <strong>Vestfold og Telemark</strong>
              <span>
                Brevik, Holmestrand, Horten, Kragerø, Langesund, Larvik,
                Notodden, Porsgrunn, Rjukan, Sandefjord, Skien, Stathelle,
                Stavern, Tønsberg
              </span>
            </span>
          ),
          deleteButtonLabel: 'Fjern Vestfold og Telemark',
        },
        {
          label: 'Vestland',
          value: 'Ves',
          keywords: ['vestland', 'hordaland', 'sogn og fjordane'],
          formattedLabel: (
            <span style={{ display: 'flex', flexDirection: 'column' }}>
              <strong>Vestland</strong>
              <span>Bergen, Florø, Førde, Måløy, Odda, Stord</span>
            </span>
          ),
          deleteButtonLabel: 'Fjern Vestland',
        },
        {
          label: 'Viken',
          value: 'Vik',
          keywords: ['viken', 'østfold', 'akershus', 'buskerud'],
          formattedLabel: (
            <span style={{ display: 'flex', flexDirection: 'column' }}>
              <strong>Viken</strong>
              <span>
                Askim, Drammen, Drøbak, Fredrikstad, Halden, Hokksund, Hønefoss,
                Jessheim, Kongsberg, Lillestrøm, Moss, Mysen, Sandvika,
                Sarpsborg, Ski, Svelvik
              </span>
            </span>
          ),
          deleteButtonLabel: 'Fjern Viken',
        },
      ],
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

## Egenskaper

<ArgsTable story='Normal' />

## Tilgjengelighet

### Mus

Nedtrekkslisten åpnes ved å klikke på feltet med musen. Deretter kan man klikke på alternativene man ønsker å velge.
Klikker man på et allerede valgt alternativ, fjernes alternativet igjen fra listen over valgte alternativer.
Hvis alternativet ikke er synlig, kan man rulle seg frem til det ved bruk av rullefelt eller musehjul.
Man kan også fjerne alternativer ved å klikke på krysset ved siden av alternativet man ønsker å fjerne.
Klikker man på krysset helt til høyre i feltet, fjernes alle alternativene.

### Tastatur

Nedtrekkslisten åpnes ved å trykke på `Enter`, `Space` eller en av de vertikale piltastene når pilknappen har fokus.
Deretter kan man navigere seg frem til ønsket alternativ ved bruk av piltastene.
Man velger så alternativer ved å bruke `Enter`- eller `Space`-tasten.
Sletteknappene (de med kryss på) nås på vanlig måte ved hjelp av tabulatortasten.

## Tokens

<TokensTable
  jsonKey='component.select'
  componentName='select'
  showPreview={false}
  description
/>
